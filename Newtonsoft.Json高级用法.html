<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="origin" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <title>Newtonsoft.Json高级用法 - 焰尾迭 - 博客园</title>
    <meta property="og:description" content="手机端应用讲究速度快，体验好。刚好手头上的一个项目服务端接口有性能问题，需要进行优化。在接口多次修改中，实体添加了很多字段用于中间计算或者存储，然后最终用Newtonsoft.Json进行序列化返回数" />
    <link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=svlZeZMvc3He7PqOD4T7SOuQn0_kIfLBYiy3idqd35Y1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/nature/bundle-nature.css?v=SMSmqROZamyrz003uRLsZZQqisVE_ymEDyPy07GKHPw1"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/nature/bundle-nature-mobile.css?v=VZZEnQMdg-BsJTaEBylBBpwMjz7m5pJk7f5Ix5zA_lA1"/>
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/yanweidie/rss"/>
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/yanweidie/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/yanweidie/wlwmanifest.xml"/>
    <script src="//common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script>var currentBlogId=114902;var currentBlogApp='yanweidie',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="/bundles/blog-common.js?v=jRyV_qDu-4wPc6tJs6U-WEk24ivFCfVIHz5t3j6euGM1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--PageBeginHtml Block Begin-->
<link href="https://files.cnblogs.com/yanweidie/main.css?ver=20160929" rel="stylesheet" type="text/css">
<!--PageBeginHtml Block End-->

<!--done-->
<div id="banner"><div id="bnr_pic">
<!--done-->
<div class="header">
	<div class="headerText">
		<a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/yanweidie/">焰尾迭</a><br>
	</div><br>
	<div class="headerDis">吾生也有涯，而知也无涯。以有涯随无涯，殆已。</div>
</div>
</div></div>
<div id="main">
	<!-- left starts -->
	<div id="left">
		<DIV id="mystats">
			<br/>
				<div id="blog_stats">
<!--done-->
<div class="blogStats">
随笔 - 43&nbsp;
文章 - 0&nbsp;
评论 - 1141&nbsp;

</div></div>
			
		</DIV>
		<div id="mylinks">
<!--done-->
<a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">博客园</a>&nbsp;&nbsp;<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/yanweidie/">首页</a>&nbsp;&nbsp;<a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a>&nbsp;&nbsp;<a id="blog_nav_contact" accesskey="9" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/%E7%84%B0%E5%B0%BE%E8%BF%AD">联系</a>&nbsp;&nbsp;<a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a>&nbsp;&nbsp;<a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/yanweidie/rss">订阅</a>&nbsp;<a id="blog_nav_rss_image" href="https://www.cnblogs.com/yanweidie/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a></div>
		<div id="topics">
			
        <div id="post_detail">
<div class="post">
	<div class="postTitle">
		<h1><a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/yanweidie/p/4605212.html">Newtonsoft.Json高级用法</a></h1>
	</div>
	<div id="cnblogs_post_body" class="blogpost-body"><p><a name="_labelTop"></a></p>
<p>　　手机端应用讲究速度快，体验好。刚好手头上的一个项目服务端接口有性能问题，需要进行优化。在接口多次修改中，实体添加了很多字段用于中间计算或者存储，然后最终用Newtonsoft.Json进行序列化返回数据，经过分析一个简单的列表接口每一行数据返回了16个字段，但是手机APP端只用到了其中7个字段，剩余9个字段的数据全部都是多余的，如果接口返回数据为40K大小，也就是说大约20K的数据为无效数据，3G网络下20K下载差不多需要1s，不返回无效数据至少可以节约1s的时间，大大提高用户体验。本篇将为大家介绍Newtonsoft.Json的一些高级用法，可以修改很少的代码解决上述问题。</p>
<p><strong>阅读目录</strong></p>
<ul>
<li><a href="#_label0">Newtonsoft.Json介绍</a></li>
<li><a href="#_label1">基本用法</a></li>
<li><a href="#_label2">高级用法</a></li>
<li><a href="#_label3">总结</a></li>
</ul>
<div style="text-align: right;"><a href="#_labelTop">回到顶部</a><a name="_label0"></a></div>
<h1 class="title">Newtonsoft.Json介绍</h1>
<p>　　在做开发的时候，很多数据交换都是以json格式传输的。而使用Json的时候，我们很多时候会涉及到几个序列化对象的使用：<strong>DataContractJsonSerializer,<strong>JavaScriptSerializer </strong></strong>和<a title="Json.NET地址" href="http://json.codeplex.com" target="_blank"><strong><strong> Json.NET</strong></strong></a>即Newtonsoft.Json。大多数人都会选择性能以及通用性较好Json.NET，这个不是微软的类库，但是一个开源的世界级的Json操作类库，从下面的性能对比就可以看到它的其中之一的性能优点。</p>
<p><img src="https://images0.cnblogs.com/i/8867/201404/282228152051648.png" alt="" /></p>
<p>齐全的<a href="http://www.newtonsoft.com/json/help/html/N_Newtonsoft_Json.htm" target="_blank">API</a>介绍，使用方式简单</p>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/281434460338410.png" alt="" width="499" height="354" /></p>
<p>&nbsp;</p>
<div style="text-align: right;"><a href="#_labelTop">回到顶部</a><a name="_label1"></a></div>
<h1 class="title">基本用法</h1>
<p>　　Json.Net是支持序列化和反序列化DataTable,DataSet,Entity Framework和Entity的。下面分别举例说明序列化和反序列化。</p>
<p><strong>DataTable：</strong></p>
<div class="cnblogs_code">
<pre>            <span style="color: #008000;">//</span><span style="color: #008000;">序列化DataTable</span>
            DataTable dt = <span style="color: #0000ff;">new</span><span style="color: #000000;"> DataTable();
            dt.Columns.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>, Type.GetType(<span style="color: #800000;">"</span><span style="color: #800000;">System.Int32</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            dt.Columns.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span>, Type.GetType(<span style="color: #800000;">"</span><span style="color: #800000;">System.String</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            dt.Columns.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">Sex</span><span style="color: #800000;">"</span>, Type.GetType(<span style="color: #800000;">"</span><span style="color: #800000;">System.String</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            dt.Columns.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">IsMarry</span><span style="color: #800000;">"</span>, Type.GetType(<span style="color: #800000;">"</span><span style="color: #800000;">System.Boolean</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">4</span>; i++<span style="color: #000000;">)
            {
                DataRow dr </span>=<span style="color: #000000;"> dt.NewRow();
                dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>] = i + <span style="color: #800080;">1</span><span style="color: #000000;">;
                dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span>] = <span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span> +<span style="color: #000000;"> i;
                dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">Sex</span><span style="color: #800000;">"</span>] = i % <span style="color: #800080;">2</span> == <span style="color: #800080;">0</span> ? <span style="color: #800000;">"</span><span style="color: #800000;">男</span><span style="color: #800000;">"</span> : <span style="color: #800000;">"</span><span style="color: #800000;">女</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">IsMarry</span><span style="color: #800000;">"</span>] = i % <span style="color: #800080;">2</span> &gt; <span style="color: #800080;">0</span> ? <span style="color: #0000ff;">true</span> : <span style="color: #0000ff;">false</span><span style="color: #000000;">;
                dt.Rows.Add(dr);
            }
            Console.WriteLine(JsonConvert.SerializeObject(dt));</span></pre>
</div>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/281443553617087.png" alt="" /></p>
<p>利用上面字符串进行反序列化</p>
<div class="cnblogs_code">
<pre> <span style="color: #0000ff;">string</span> json =<span style="color: #000000;"> JsonConvert.SerializeObject(dt);
 dt</span>=JsonConvert.DeserializeObject&lt;DataTable&gt;<span style="color: #000000;">(json);
 </span><span style="color: #0000ff;">foreach</span> (DataRow dr <span style="color: #0000ff;">in</span><span style="color: #000000;"> dt.Rows)
 {
 　　Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">{0}\t{1}\t{2}\t{3}\t</span><span style="color: #800000;">"</span>, dr[<span style="color: #800080;">0</span>], dr[<span style="color: #800080;">1</span>], dr[<span style="color: #800080;">2</span>], dr[<span style="color: #800080;">3</span><span style="color: #000000;">]);
 }</span></pre>
</div>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/281448403619018.png" alt="" /></p>
<p>Entity序列化和DataTable一样，就不过多介绍了。</p>
<div style="text-align: right;"><a href="#_labelTop">回到顶部</a><a name="_label2"></a></div>
<h1 class="title">高级用法</h1>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.忽略某些属性</p>
<p>&nbsp;&nbsp;&nbsp; 2.默认值的处理</p>
<p>&nbsp;&nbsp;&nbsp; 3.空值的处理</p>
<p>&nbsp;&nbsp;&nbsp; 4.支持非公共成员</p>
<p>&nbsp;&nbsp;&nbsp; 5.日期处理</p>
<p>&nbsp;&nbsp;&nbsp; 6.自定义序列化的字段名称</p>
<p>　 7.动态决定属性是否序列化</p>
<p>&nbsp;&nbsp;&nbsp; 8.枚举值的自定义格式化问题</p>
<p>　 9.自定义类型转换</p>
<p>&nbsp; 10.全局序列化设置</p>
<p><strong>&nbsp;一.忽略某些属性</strong></p>
<p>　　类似本问开头介绍的接口优化，实体中有些属性不需要序列化返回，可以使用该特性。首先介绍Json.Net序列化的模式:OptOut 和 OptIn</p>
<table class="cnblogs_Highlighter" border="0" align="left">
<tbody>
<tr>
<td><span style="font-size: 15px;">OptOut </span></td>
<td><span style="font-size: 15px;">默认值,类中所有公有成员会被序列化,如果不想被序列化,可以用特性<span style="color: #808080;">JsonIgnore</span></span></td>
</tr>
<tr>
<td><span style="font-size: 15px;">OptIn</span></td>
<td><span style="font-size: 15px;">默认情况下,所有的成员不会被序列化,类中的成员只有标有特性<span style="color: #808080;">JsonProperty的才会被序列化,当类的成员很多,但客户端仅仅需要一部分数据时,很有用</span></span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>　仅需要姓名属性</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">    [JsonObject(MemberSerialization.OptIn)]
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Person
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Age { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        [JsonProperty]
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Sex { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span> IsMarry { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> DateTime Birthday { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }</span></pre>
</div>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/281508379087828.png" alt="" /></p>
<p>&nbsp; 不需要是否结婚属性</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">    [JsonObject(MemberSerialization.OptOut)]
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Person
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Age { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Sex { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        [JsonIgnore]
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span> IsMarry { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> DateTime Birthday { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }</span></pre>
</div>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/281510410171151.png" alt="" /></p>
<p>&nbsp; 通过上面的例子可以看到，要实现不返回某些属性的需求很简单。1.在实体类上加上[JsonObject(MemberSerialization.OptOut)] 2.在不需要返回的属性上加上 [JsonIgnore]说明。</p>
<p><strong>二.默认值处理</strong></p>
<p>&nbsp;&nbsp;&nbsp; 序列化时想忽略默认值属性可以通过JsonSerializerSettings.DefaultValueHandling来确定，该值为枚举值</p>
<table class="cnblogs_Highlighter" border="0" align="left">
<tbody>
<tr>
<td>
<pre><span style="font-size: 15px;"><span style="color: #2b91af;">DefaultValueHandling.Ignore
</span></span></pre>
</td>
<td><span style="font-size: 15px;">序列化和反序列化时,忽略默认值</span></td>
</tr>
<tr>
<td>
<pre><span style="font-size: 15px;"><span style="color: #2b91af;">DefaultValueHandling.Include
</span></span></pre>
</td>
<td><span style="font-size: 15px;">序列化和反序列化时,包含默认值</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre> [DefaultValue(<span style="color: #800080;">10</span><span style="color: #000000;">)]
 </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Age { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<div class="cnblogs_code">
<pre> Person p = <span style="color: #0000ff;">new</span> Person { Age = <span style="color: #800080;">10</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">张三丰</span><span style="color: #800000;">"</span>, Sex = <span style="color: #800000;">"</span><span style="color: #800000;">男</span><span style="color: #800000;">"</span>, IsMarry = <span style="color: #0000ff;">false</span>, Birthday = <span style="color: #0000ff;">new</span> DateTime(<span style="color: #800080;">1991</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">) };
 JsonSerializerSettings jsetting</span>=<span style="color: #0000ff;">new</span><span style="color: #000000;"> JsonSerializerSettings();
 jsetting.DefaultValueHandling</span>=<span style="color: #000000;">DefaultValueHandling.Ignore;
 Console.WriteLine(JsonConvert.SerializeObject(p, Formatting.Indented, jsetting));</span></pre>
</div>
<p>最终结果如下：</p>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/290700436652801.png" alt="" /></p>
<p>&nbsp;</p>
<p><strong>三.空值的处理</strong></p>
<p><strong>　　</strong>序列化时需要忽略值为NULL的属性，可以通过JsonSerializerSettings.NullValueHandling来确定，另外通过JsonSerializerSettings设置属性是对序列化过程中所有属性生效的，想单独对某一个属性生效可以使用JsonProperty，下面将分别展示两个方式</p>
<p>　　1.JsonSerializerSettings</p>
<div class="cnblogs_code">
<pre> Person p = <span style="color: #0000ff;">new</span> Person { room=<span style="color: #0000ff;">null</span>,Age = <span style="color: #800080;">10</span>, Name = <span style="color: #800000;">"</span><span style="color: #800000;">张三丰</span><span style="color: #800000;">"</span>, Sex = <span style="color: #800000;">"</span><span style="color: #800000;">男</span><span style="color: #800000;">"</span>, IsMarry = <span style="color: #0000ff;">false</span>, Birthday = <span style="color: #0000ff;">new</span> DateTime(<span style="color: #800080;">1991</span>, <span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">) };
 JsonSerializerSettings jsetting</span>=<span style="color: #0000ff;">new</span><span style="color: #000000;"> JsonSerializerSettings();
 jsetting.NullValueHandling </span>=<span style="color: #000000;"> NullValueHandling.Ignore;
 Console.WriteLine(JsonConvert.SerializeObject(p, Formatting.Indented, jsetting));</span></pre>
</div>
<p>&nbsp;&nbsp; <img src="https://images0.cnblogs.com/blog2015/336693/201506/290707560092150.png" alt="" /></p>
<p>&nbsp;&nbsp; 2.JsonProperty</p>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/290710397909914.png" alt="" /></p>
<p>通过JsonProperty属性设置的方法，可以实现某一属性特别处理的需求，如默认值处理，空值处理，自定义属性名处理，格式化处理。上面空值处理实现</p>
<div class="cnblogs_code">
<pre> [JsonProperty(NullValueHandling=<span style="color: #000000;">NullValueHandling.Ignore)]
 </span><span style="color: #0000ff;">public</span> Room room { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<p>&nbsp;</p>
<p><strong>四.支持非公共成员</strong></p>
<p>&nbsp; 序列化时默认都是处理公共成员，如果需要处理非公共成员，就要在该成员上加特性"<span style="color: #888888;">JsonProperty"</span></p>
<div class="cnblogs_code">
<pre><span style="color: #000000;"> [JsonProperty]
 </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> Height { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<p>&nbsp;</p>
<p><strong>五.日期处理</strong></p>
<p><strong>　</strong>　对于Dateime类型日期的格式化就比较麻烦了，系统自带的会格式化成iso日期标准<img src="https://images0.cnblogs.com/blog2015/336693/201506/290743047903040.png" alt="" />，但是实际使用过程中大多数使用的可能是yyyy-MM-dd 或者yyyy-MM-dd HH:mm:ss两种格式的日期，解决办法是可以将DateTime类型改成string类型自己格式化好，然后在序列化。如果不想修改代码，可以采用下面方案实现。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Json.Net提供了IsoDateTimeConverter日期转换这个类，可以通过JsnConverter实现相应的日期转换</p>
<div class="cnblogs_code">
<pre>    [JsonConverter(<span style="color: #0000ff;">typeof</span><span style="color: #000000;">(IsoDateTimeConverter))]
    </span><span style="color: #0000ff;">public</span> DateTime Birthday { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<p>　　但是IsoDateTimeConverter日期格式不是我们想要的，我们可以继承该类实现自己的日期</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ChinaDateTimeConverter : DateTimeConverterBase
    {
        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> IsoDateTimeConverter dtConverter = <span style="color: #0000ff;">new</span> IsoDateTimeConverter { DateTimeFormat = <span style="color: #800000;">"</span><span style="color: #800000;">yyyy-MM-dd</span><span style="color: #800000;">"</span><span style="color: #000000;"> };

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">object</span> ReadJson(JsonReader reader, Type objectType, <span style="color: #0000ff;">object</span><span style="color: #000000;"> existingValue, JsonSerializer serializer)
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> dtConverter.ReadJson(reader, objectType, existingValue, serializer);
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span> WriteJson(JsonWriter writer, <span style="color: #0000ff;">object</span><span style="color: #000000;"> value, JsonSerializer serializer)
        {
            dtConverter.WriteJson(writer, value, serializer);
        }
    }</span></pre>
</div>
<p>&nbsp;&nbsp;&nbsp; 自己实现了一个yyyy-MM-dd格式化转换类，可以看到只是初始化IsoDateTimeConverter时给的日期格式为yyyy-MM-dd即可，下面看下效果</p>
<div class="cnblogs_code">
<pre>[JsonConverter(<span style="color: #0000ff;">typeof</span><span style="color: #000000;">(ChinaDateTimeConverter))]
</span><span style="color: #0000ff;">public</span> DateTime Birthday { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<p><img src="https://images0.cnblogs.com/blog2015/336693/201506/290750116036578.png" alt="" /></p>
<p>&nbsp;&nbsp; 可以根据自己需求实现不同的转换类</p>
<p>&nbsp;</p>
<p><strong><strong>六.自定义序列化的字段名称</strong></strong></p>
<p><strong><strong>&nbsp;&nbsp;&nbsp; </strong></strong>实体中定义的属性名可能不是自己想要的名称，但是又不能更改实体定义，这个时候可以自定义序列化字段名称。</p>
<div class="cnblogs_code">
<pre>     [JsonProperty(PropertyName = <span style="color: #800000;">"</span><span style="color: #800000;">CName</span><span style="color: #800000;">"</span><span style="color: #000000;">)]
     </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<p>&nbsp;</p>
<p><strong><strong>七.动态决定属性是否序列化</strong></strong></p>
<p><strong><strong>　　</strong></strong>这个是为了实现@米粒儿提的需求特别增加的，根据某些场景，可能A场景输出A，B，C三个属性，B场景输出E，F属性。虽然实际中不一定存在这种需求，但是json.net依然可以支持该特性。</p>
<p>　　继承默认的DefaultContractResolver类，传入需要输出的属性</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 重写修改了一下，大多数情况下应该是要排除的字段少于要保留的字段,&nbsp;&nbsp;为了方便书写这里修改了构造函数加入retain表示props是需要保留的字段还是要排除的字段</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> LimitPropsContractResolver : DefaultContractResolver
    {
        </span><span style="color: #0000ff;">string</span>[] props = <span style="color: #0000ff;">null</span><span style="color: #000000;">;

        </span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> retain;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 构造函数
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="props"&gt;</span><span style="color: #008000;">传入的属性数组</span><span style="color: #808080;">&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="retain"&gt;</span><span style="color: #008000;">true:表示props是需要保留的字段  false：表示props是要排除的字段</span><span style="color: #808080;">&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> LimitPropsContractResolver(<span style="color: #0000ff;">string</span>[] props, <span style="color: #0000ff;">bool</span> retain=<span style="color: #0000ff;">true</span><span style="color: #000000;">)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">指定要序列化属性的清单</span>
            <span style="color: #0000ff;">this</span>.props =<span style="color: #000000;"> props;

            </span><span style="color: #0000ff;">this</span>.retain =<span style="color: #000000;"> retain;
        }

        </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">override</span> IList&lt;JsonProperty&gt;<span style="color: #000000;"> CreateProperties(Type type,

        MemberSerialization memberSerialization)
        {
            IList</span>&lt;JsonProperty&gt; list =
            <span style="color: #0000ff;">base</span><span style="color: #000000;">.CreateProperties(type, memberSerialization);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">只保留清单有列出的属性</span>
            <span style="color: #0000ff;">return</span> list.Where(p =&gt;<span style="color: #000000;"> {
                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (retain)
                {
                    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> props.Contains(p.PropertyName);
                }
                </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
                {
                    </span><span style="color: #0000ff;">return</span> !<span style="color: #000000;">props.Contains(p.PropertyName);
                }      
            }).ToList();
        }
    </span></pre>
</div>
<div class="cnblogs_code">
<pre>        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Age { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        [JsonIgnore]
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span> IsMarry { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Sex { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span>; }</pre>
</div>
<div class="cnblogs_code">
<pre>      JsonSerializerSettings jsetting=<span style="color: #0000ff;">new</span><span style="color: #000000;"> JsonSerializerSettings();
      jsetting.ContractResolver </span>= <span style="color: #0000ff;">new</span> LimitPropsContractResolver(<span style="color: #0000ff;">new</span> <span style="color: #0000ff;">string</span>[] { <span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">IsMarry</span><span style="color: #800000;">"</span><span style="color: #000000;"> });
      Console.WriteLine(JsonConvert.SerializeObject(p, Formatting.Indented, jsetting));</span></pre>
</div>
<p>&nbsp; 使用自定义的解析类，只输出<span style="color: #800000;">"<span style="color: #800000;">Age<span style="color: #800000;">", <span style="color: #800000;">"<span style="color: #800000;">IsMarry<span style="color: #800000;">"</span></span></span></span></span></span>两个属性，看下最终结果.只输出了Age属性，为什么IsMarry属性没有输出呢，因为标注了JsonIgnore</p>
<p>&nbsp;<img src="https://images0.cnblogs.com/blog2015/336693/201506/292128345097430.png" alt="" /></p>
<p>&nbsp;看到上面的结果想要实现pc端序列化一部分，手机端序列化另一部分就很简单了吧，我们改下代码实现一下</p>
<div class="cnblogs_code">
<pre>  <span style="color: #0000ff;">string</span>[] propNames = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
  </span><span style="color: #0000ff;">if</span> (p.Age &gt; <span style="color: #800080;">10</span><span style="color: #000000;">)
  {
  　　propNames </span>= <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">string</span>[] { <span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">IsMarry</span><span style="color: #800000;">"</span><span style="color: #000000;"> };
  }
  </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
  {
      propNames </span>= <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">string</span>[] { <span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">Sex</span><span style="color: #800000;">"</span><span style="color: #000000;"> };
  }
  jsetting.ContractResolver </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> LimitPropsContractResolver(propNames);
  Console.WriteLine(JsonConvert.SerializeObject(p, Formatting.Indented, jsetting));</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><strong>八.枚举值的自定义格式化问题</strong></strong></p>
<p><strong><strong>&nbsp;</strong></strong> 默认情况下对于实体里面的枚举类型系统是格式化成改枚举对应的整型数值,那如果需要格式化成枚举对应的字符怎么处理呢？Newtonsoft.Json也帮我们想到了这点，下面看实例</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">enum</span><span style="color: #000000;"> NotifyType
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> Emil发送
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        Mail=<span style="color: #800080;">0</span><span style="color: #000000;">,

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 短信发送
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        SMS=<span style="color: #800080;">1</span><span style="color: #000000;">
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestEnmu
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 消息发送类型
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> NotifyType Type { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }
    JsonConvert.SerializeObject(</span><span style="color: #0000ff;">new</span> TestEnmu());</pre>
</div>
<p>输出结果：<img src="https://images2015.cnblogs.com/blog/336693/201509/336693-20150910171743028-388882267.png" alt="" />&nbsp; 现在改造一下，输出"Type":"Mail"</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestEnmu
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 消息发送类型
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        [JsonConverter(<span style="color: #0000ff;">typeof</span><span style="color: #000000;">(StringEnumConverter))]
        </span><span style="color: #0000ff;">public</span> NotifyType Type { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }</span></pre>
</div>
<p>其它的都不变，在Type属性上加上了JsonConverter(<span style="color: #0000ff;">typeof<span style="color: #000000;">(StringEnumConverter))表示将枚举值转换成对应的字符串,而StringEnumConverter是Newtonsoft.Json内置的转换类型,最终输出结果</span></span></p>
<p><span style="color: #0000ff;"><span style="color: #000000;"><img src="https://images2015.cnblogs.com/blog/336693/201509/336693-20150910172109044-1714459886.png" alt="" /></span></span></p>
<p>&nbsp;</p>
<p><strong><strong>九.自定义类型转换</strong></strong></p>
<p>默认情况下对于实体里面的Boolean系统是格式化成true或者false,对于true转成"是" false转成"否"这种需求改怎么实现了？我们可以自定义类型转换实现该需求，下面看实例</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> BoolConvert : JsonConverter
    {
        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">string</span>[] arrBString { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> BoolConvert()
        {
            arrBString </span>= <span style="color: #800000;">"</span><span style="color: #800000;">是,否</span><span style="color: #800000;">"</span>.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">);
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 构造函数
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="BooleanString"&gt;</span><span style="color: #008000;">将bool值转换成的字符串值</span><span style="color: #808080;">&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> BoolConvert(<span style="color: #0000ff;">string</span><span style="color: #000000;"> BooleanString)
        {
            </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">string</span><span style="color: #000000;">.IsNullOrEmpty(BooleanString))
            {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ArgumentNullException();
            }
            arrBString </span>= BooleanString.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (arrBString.Length != <span style="color: #800080;">2</span><span style="color: #000000;">)
            {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentException(<span style="color: #800000;">"</span><span style="color: #800000;">BooleanString格式不符合规定</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }


        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">object</span> ReadJson(JsonReader reader, Type objectType, <span style="color: #0000ff;">object</span><span style="color: #000000;"> existingValue, JsonSerializer serializer)
        {
            </span><span style="color: #0000ff;">bool</span> isNullable =<span style="color: #000000;"> IsNullableType(objectType);
            Type t </span>= isNullable ?<span style="color: #000000;"> Nullable.GetUnderlyingType(objectType) : objectType;

            </span><span style="color: #0000ff;">if</span> (reader.TokenType ==<span style="color: #000000;"> JsonToken.Null)
            {
                </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">IsNullableType(objectType))
                {
                    </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(<span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">"</span><span style="color: #800000;">不能转换null value to {0}.</span><span style="color: #800000;">"</span><span style="color: #000000;">, objectType));
                }

                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
            }

            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">if</span> (reader.TokenType ==<span style="color: #000000;"> JsonToken.String)
                {
                    </span><span style="color: #0000ff;">string</span> boolText =<span style="color: #000000;"> reader.Value.ToString();
                    </span><span style="color: #0000ff;">if</span> (boolText.Equals(arrBString[<span style="color: #800080;">0</span><span style="color: #000000;">], StringComparison.OrdinalIgnoreCase))
                    {
                        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
                    }
                    </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (boolText.Equals(arrBString[<span style="color: #800080;">1</span><span style="color: #000000;">], StringComparison.OrdinalIgnoreCase))
                    {
                        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
                    }
                }

                </span><span style="color: #0000ff;">if</span> (reader.TokenType ==<span style="color: #000000;"> JsonToken.Integer)
                {
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">数值</span>
                    <span style="color: #0000ff;">return</span> Convert.ToInt32(reader.Value) == <span style="color: #800080;">1</span><span style="color: #000000;">;
                }
            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception ex)
            {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(<span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">"</span><span style="color: #800000;">Error converting value {0} to type '{1}'</span><span style="color: #800000;">"</span><span style="color: #000000;">, reader.Value, objectType));
            }
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(<span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">"</span><span style="color: #800000;">Unexpected token {0} when parsing enum</span><span style="color: #800000;">"</span><span style="color: #000000;">, reader.TokenType));
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 判断是否为Bool类型
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="objectType"&gt;</span><span style="color: #008000;">类型</span><span style="color: #808080;">&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">为bool类型则可以进行转换</span><span style="color: #808080;">&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> CanConvert(Type objectType)
        {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        }


        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> IsNullableType(Type t)
        {
            </span><span style="color: #0000ff;">if</span> (t == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentNullException(<span style="color: #800000;">"</span><span style="color: #800000;">t</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            </span><span style="color: #0000ff;">return</span> (t.BaseType.FullName==<span style="color: #800000;">"</span><span style="color: #800000;">System.ValueType</span><span style="color: #800000;">"</span> &amp;&amp; t.GetGenericTypeDefinition() == <span style="color: #0000ff;">typeof</span>(Nullable&lt;&gt;<span style="color: #000000;">));
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span> WriteJson(JsonWriter writer, <span style="color: #0000ff;">object</span><span style="color: #000000;"> value, JsonSerializer serializer)
        {
            </span><span style="color: #0000ff;">if</span> (value == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                writer.WriteNull();
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
            }

            </span><span style="color: #0000ff;">bool</span> bValue = (<span style="color: #0000ff;">bool</span><span style="color: #000000;">)value;

            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (bValue)
            {
                writer.WriteValue(arrBString[</span><span style="color: #800080;">0</span><span style="color: #000000;">]);
            }
            </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
            {
                writer.WriteValue(arrBString[</span><span style="color: #800080;">1</span><span style="color: #000000;">]);
            }
        }
    }</span></pre>
</div>
<p>&nbsp;自定义了BoolConvert类型，继承自JsonConverter。构造函数参数BooleanString可以让我们自定义将true false转换成相应字符串。下面看实体里面怎么使用这个自定义转换类型</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Person
    {
        [JsonConverter(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(BoolConvert))]
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span> IsMarry { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/336693/201512/336693-20151214101004068-161668511.png" alt="" />&lsquo;</p>
<p>相应的有什么个性化的转换需求，都可以使用自定义转换类型的方式实现。</p>
<p>&nbsp;</p>
<p><strong><strong>十.全局序列化设置</strong></strong></p>
<p>文章开头提出了Null值字段怎么不返回的问题，相应的在高级用法也给出了相应的解决方案使用jsetting.NullValueHandling = NullValueHandling.Ignore; 来设置不返回空值。这样有个麻烦的地方，每个不想返回空值的序列化都需设置一下。可以对序列化设置一些默认值方式么？下面将解答</p>
<div class="cnblogs_code">
<pre>　　Newtonsoft.Json.JsonSerializerSettings setting = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Newtonsoft.Json.JsonSerializerSettings();
   JsonConvert.DefaultSettings </span>= <span style="color: #0000ff;">new</span> Func&lt;JsonSerializerSettings&gt;(() =&gt;<span style="color: #000000;">
   {<br /><span style="color: #ff0000;">　　　　//日期类型默认格式化处理</span>
   　　setting.DateFormatHandling </span>=<span style="color: #000000;"> Newtonsoft.Json.DateFormatHandling.MicrosoftDateFormat;
      setting.DateFormatString </span>= <span style="color: #800000;">"</span><span style="color: #800000;">yyyy-MM-dd HH:mm:ss</span><span style="color: #800000;">"</span><span style="color: #000000;">;
<br />　　<span style="color: #ff0000;">　 //空值处理</span>
      setting.NullValueHandling </span>=<span style="color: #000000;"> NullValueHandling.Ignore;<br /><br /><span style="color: #ff0000;">      //高级用法九中的Bool类型转换 设置</span>
      setting.Converters.Add(</span><span style="color: #0000ff;">new</span> BoolConvert(<span style="color: #800000;">"</span><span style="color: #800000;">是,否</span><span style="color: #800000;">"</span><span style="color: #000000;">));

      </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> setting;
   });</span></pre>
</div>
<p>&nbsp;</p>
<p>这样设置以后，以后使用序列化的地方就不需要单独设置了，个人最喜欢设置的是空值处理这一块。</p>
<div style="text-align: right;"><a href="#_labelTop">回到顶部</a><a name="_label3"></a></div>
<h1 class="title">总结</h1>
<p>　　Newtonsoft.Json序列化库替我们想了很多特性，也实现了很多特性，除了上面介绍的几种高级用法外，还有其它的特殊用法，可以去官网进行学习。当然这里我目前最喜欢的特性就是那个忽略部分属性序列化的功能，很小的代码改动实现了接口的优化，提升了用户体验。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="articleFooter">
<p>如果，您认为阅读这篇博客让您有些收获，不妨点击一下右下角的<a id="btnRecommendMyBlog" href="javascript:void(0);">【<strong>推荐</strong>】</a>按钮。<br />
如果，您希望更容易地发现我的新博客，不妨点击一下绿色通道的<a onclick="c_follow();" href="javascript:void(0);">【<strong>关注我</strong>】</a>。</p>
<div class="blogds">如果，想给予我更多的鼓励，<span class="bold">求打</span>
 <a id="btn_donate" class="btn_donate" style="position: absolute;" title="Donate 打赏" href="javascript:void(0);" target="_self"></a>
</div>
<p>因为，我的写作热情也离不开您的肯定支持。</p>
<p>感谢您的阅读，如果您对我的博客所讲述的内容有兴趣，请继续关注我的后续博客，我是焰尾迭 。</p>

</div></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


	<div class="postDesc">posted on <span id="post-date">2015-06-29 07:58</span> <a href='https://www.cnblogs.com/yanweidie/'>焰尾迭</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="https://i.cnblogs.com/EditPosts.aspx?postid=4605212" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(4605212);return false;">收藏</a></div>
</div>
<script type="text/javascript">var allowComments=true,cb_blogId=114902,cb_entryId=4605212,cb_blogApp=currentBlogApp,cb_blogUserGuid='91ae0150-efe9-e011-8ee0-842b2b196315',cb_entryCreatedDate='2015/6/29 7:58:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>

</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id='cnblogs_c1' class='c_ad_block'>
    <div id='div-gpt-ad-1546353474406-0' style='height:250px; width:300px;'></div>
</div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'>
    <div id='div-gpt-ad-1539008685004-0' style='height:60px; width:468px;'></div>
</div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
		</div>
	</div>
	<!-- left ends -->
	<!-- right starts -->
	<div id="right">
		<!-- 右侧工具部分 -->
		<div id="right_content">
	
			
<!--done-->
<h2 class="listtitle">公告</h2>
<div class="newsItem">
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

	
			<div id="calendar"><div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
			
				<DIV id="leftcontentcontainer">
					<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
				</DIV>
			
		</div>
		<!-- //右侧工具部分 -->
		<div id="footer">
			
<!--done-->
Copyright &copy;2019 焰尾迭
		</div>
	</div>
	<!-- right ends -->
	<div class="clear"></div>
	
</div>


<!--PageEndHtml Block Begin-->
<script type="text/javascript" src="https://files.cnblogs.com/files/yanweidie/yanweidie.js?ver=20160929"></script>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=54660472" charset="UTF-8"></script>
<div  id="layui-layer-shade"  style="position:fixed;left:0;top:0;width:100%;height:100%;z-index:9999; background-color:#000; opacity:0.3; filter:alpha(opacity=30);display: none;"></div>
<div id="layui-layer-content" style="display: none;position: fixed;z-index:10000;height: 200px;width: 400px;left: 50%;top: 50%;margin-left: -200px;margin-top: -100px;">
    <div align="center" ><a href="javascript:void(0)" style="padding-right: 30px;"><img width="180" height="180" class="alignnone" alt="支付宝捐赠" src="https://images2015.cnblogs.com/blog/336693/201605/336693-20160524174752163-1554089556.png"></a> <a href="javascript:void(0)"> <img width="180" height="180" class="alignnoe" alt="微信打赏" src="https://images2015.cnblogs.com/blog/336693/201605/336693-20160524174809834-1334095025.png"></a></div><div style="text-align: center;"><strong><span style="color: rgb(51, 127, 229);">欢迎资助我持续写作，</span><span style="color: rgb(255, 102, 0);">金额随意,欢迎来赏！</span></strong></div>
</div>
<div style="display: none;" id="rocket-to-top">
    <div style="opacity:0;display: block;" class="level-2"></div>
    <div class="level-3"></div>
</div>
<!--PageEndHtml Block End-->
</body>
</html>
